ifdef::env-github[]
:tip-caption: :bulb:
:note-caption: :information_source:
:important-caption: :heavy_exclamation_mark:
:caution-caption: :fire:
:warning-caption: :warning:
endif::[]
ifndef::env-github[]
endif::[]

= Spring Cloud Data Flow Carvel Documentation

toc::[]

ifdef::env-github[]

link:configuration-options.adoc[Configuration Options]

link:servers.adoc[Servers]

link:binder.adoc[Binder]

link:database.adoc[Database]

endif::[]

Main objectives for a https://carvel.dev[Carvel] integration with dataflow is to provide:

* We want to have exactly one common way to generate k8s resources
** Can generate set of samples automatically
** Can be used for all other use cases when deploying to k8s
* Automatically configure whole environment based on user choices
* Easy deployment without requiring existing external _binder_ or _database_
** Can deploy either rabbit or kafka as a binder
** Can deploy either mysql or postgres as a database
* Plain k8s templating using https://carvel.dev/ytt[ytt]
** Drive templating with template options
** Work with _kubectl_ without need _kapp_ or _kapp-controller_
* Package management using https://carvel.dev/kapp-controller[kapp-controller]
** Publish packages for dataflow versions
** Drive package deployment with given package options
* Step away if user configures external _binder_ or _database_

[NOTE]
====
While templating can deploy _binder_ and _database_ automatially it is not supported
production configuration and should be taken as a simple install as a trial to get
things up and running. It's highly advised to use proper deployment of _binder_ and
_database_ as automatic deployment and configuration of those are limited.
====

== Deploy Spring Cloud Data Flow
There are different ways to deploy _Dataflow_ into k8s cluster:

* _kubectl_ with _ytt_ templating
* _kapp_ with passed deployed files from _ytt_ templates
* _kapp-controller_ with _carvel_ package with configured options
* _tanzu-cli_ which essentially is _kapp-controller_ but with a different flavour of API

=== Deploy via kubectl
Lowest level deployment as you are essentially passing k8s yml files generated from
_ytt_ templates.

=== Deploy via kapp
Essentially much like deploying with _kubectl_ but uses _kapp_ spesific annotations
to give some sense of how deployments are done on an order.

=== Deploy via kapp-controller
Takes use of a _carvel_ package and deploys via controller with given options.

=== Deploy via tanzu cli
Essentially like deploying with _kapp-controller_ where _Tanzu CLI_ gives higher
level of package management.
